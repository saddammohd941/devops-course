go to aws account create 3 ec2 instances in same availabilityzone


take access of all machines via putty or git bash or mobaxterm

now go inside ansible server and download package

[   ]$ wget https://dl.fedoraproject.org/pub/epel/epel-release-latest-7.noarch.rpm

now do "ls"

[   ]# yum install epel-release-latest-7.noarch.rpm

[   ]# yum update -y

now we have to install all the packages are one by one

[   ]# yum install git python python-devel python-pip openssl ansible -y

Install Ansible using amazon-linux-extras Repository
Ansible package can be installed on amazon linux using amazon provided packages.

[   ]# sudo amazon-linux-extras install ansible2

Check Ansible version
To verify whether Ansible is installed on your machine, you can verify it as follows,

[   ]# ansible --version

ansible 2.9.13
config file = /etc/ansible/ansible.cfg
configured module search path = [u'/root/.ansible/plugins/modules', u'/usr/share/ansible/plugins/modules']
ansible python module location = /usr/lib/python2.7/site-packages/ansible
executable location = /bin/ansible
python version = 2.7.18 (default, Aug 27 2020, 21:22:52) [GCC 7.3.1 20180712 (Red Hat 7.3.1-9)]

now go to hosts file inside ansible server and paste private ip of node1 & node2

[   ]# vi /etc/ansible/hosts

[demo]
13.233.11.237
13.233.250.81
[dev group]
13.233.11.237
[ops group]
13.233.250.81

now this hosts file is only working a file updating ansible.cfg file

[   ] # vi etc/ansible/ansible.cfg

uncommit [remove # from this]

inventory = /etc/ansible/hosts
sudo-user = root

now create one user, in all the three instances

[   ] # useradd ansible

now set password for this user

[   ] # passwd ansible

now switch as ansible user 

[   ] # su - ansible

this ansible user dont have sudo priviliages right now if you want to give sudo priviliages to ansible user

[root@ ip ] # visudo (or) vi /etc/sudoers

now go to inside the file 

root    ALL=(ALL)     ALL
ansible ALL=(ALL) NOPASSWD=ALL
:wq!

now do this thing in other nodes also now go the ansible server and try is inside httpd package as a ansible user

[ansible@ip]# sudo yum install httpd -y

now establish connection between server and node go to ansible server

[ansible@ip]$ ssh ip address

permisssion denied

now we have to do some changes in sshd_config file go to ansible server do some changes & saved the file

[root@ip]$ vi /etc/ssh/sshd_config
 
 PermitRootLogin yes
 PasswordAuthentication yes
 #PermitEmptyPasswords no
 #PasswordAuthentication no

do this work node1 & node2 also

now verify in ansible server

[root@ip] $ su - ansible

[ansible@ip]$ ssh ip address

now it ask for password enter the password after that you will be inside the node1
